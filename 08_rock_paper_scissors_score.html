<!DOCTYPE html>
<html>

<head>
    <title> Ch08 Objects: rock paper scissors </title>
    <style>
        /*css*/
    </style>
</head>

<body>
    <!--html -->
    <p> <strong>Game Logic</strong>: <br>
        as we click a button <br>
        1: Computer randomly selects a move.<br>
        1-1: use random number to generate a float between 0~1.<br>
        1-2: use 1/3, 2/3 to distinguish 3 cases. if in corresponding interval then comouter chooses R/P/S.<br>
        2: Compare the moves(user chosen one) to get the results.<br>
        3: Display the result in a popup. <br>
    </p>
    <hr>
    <h3> Rock paper scissors </h3>

    <button data-user_move="rock"> Rock </button>
    <button data-user_move="paper"> Paper </button>
    <button data-user_move="scissors"> Scissors </button>
    <button id="reset-btn"> Reset Score</button>
    <!-- we need to add a button and then using it to update the score-->


    <script>
        // js code
        // functions we need:
        // 1, random generated computer move
        // 2, compare user and computer move, give results
        // !!! 3-2, update and display the result and score in a popup.
        // 3, create a pop up saying tie, win or lose.
        // use data- to define, and decouple the actual button context with the data name.
        // always put global variables first, then logic(functions), then call them and connect them to the elements on html-page.

        // variables:
        let computer_move = '';
        const score = {
            wins : 0,
            losses: 0,
            ties: 0
        }
        // functions: 
        function getComputerMove() {
            const random_number = Math.random();
            // Rock case, 0 ~ 1/3
            // Paper case, 1/3 ~ 2/3
            // Scissors case, 2/3 ~ 1
            let computer_move = '';
            if (random_number >= 0 && random_number < (1 / 3)) {
                computer_move = 'rock';
                console.log('computer move is rock');
            } else if (random_number >= 1 / 3 && random_number < (2 / 3)) {
                computer_move = 'paper';
                console.log('computer move is paper');
            } else if (random_number >= 2 / 3 && random_number < 1) {
                computer_move = 'scissors';
                console.log('computer move is scissors');
            }
            return computer_move;
        }

        function compareMoves(user_move, computer_move) {
            let result = '???';
            // console.log('check user move');
            // console.log(user_move);

            // console.log('check computer move');
            // console.log(computer_move);

            // console.log('check 01');
            // console.log(result);
            if (user_move === computer_move) {
                result = `you both picked ${user_move}, Tie.`
                return result;
            }
            // user rock case
            if (user_move === 'rock' && computer_move === 'paper') {
                result = `you picked ${user_move}, computer picked ${computer_move}, You lose.`
            } else if (user_move === 'rock' && computer_move === 'scissors') {
                result = `you picked ${user_move}, computer picked ${computer_move}, You win.`
            }
            
            // user paper case
            if (user_move === 'paper' && computer_move === 'scissors') {
                result = `you picked ${user_move}, computer picked ${computer_move}, You lose.`
            } else if (user_move === 'paper' && computer_move === 'rock') {
                result = `you picked ${user_move}, computer picked ${computer_move}, You win.`
            }

            // user scissors case
            if (user_move === 'scissors' && computer_move === 'rock') {
                result = `you picked ${user_move}, computer picked ${computer_move}, You lose.`
            } else if (user_move === 'scissors' && computer_move === 'paper') {
                result = `you picked ${user_move}, computer picked ${computer_move}, You win.`
            }

            // console.log(result);
            return result;
        }

        function updateScores(result) {
            if (result.includes('win')) {
                score.wins ++;
            } else if (result.includes('lose')) {
                score.losses ++;
            } else {
                score.ties ++;
            }
        }

        // binding logic
        const buttons = document.querySelectorAll("button");

        // add events for each button
        // TODO: use event delegation
        buttons.forEach(button => {
            button.addEventListener("click", () => {

                
                // get user move
                const user_move = button.dataset.user_move;

                //check if it's reset button:
                if(!user_move){
                    score.wins = 0;
                    score.losses = 0;
                    score.ties = 0;
                    alert("Score has been reset to 0!");
                    return; // nolonger go through the game logic
                
                }

                // get computer move
                computer_move = getComputerMove();

                // get results
                let result = compareMoves(user_move, computer_move);
                updateScores(result);
                // console.log(result);

                // show result
                alert(`${result}
                Wins: ${score.wins} 
                Losses: ${score.losses} 
                Ties: ${score.ties}`);
            });
        });

    </script>
</body>

</html>